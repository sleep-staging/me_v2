Loading dataloader
Done
[34m[1mwandb[39m[22m: [33mWARNING[39m Saving files without folders. If you want to preserve sub directories pass base_path to wandb.save, i.e. wandb.save("/mnt/folder/file.h5", base_path="/mnt")
[34m[1mwandb[39m[22m: [33mWARNING[39m Saving files without folders. If you want to preserve sub directories pass base_path to wandb.save, i.e. wandb.save("/mnt/folder/file.h5", base_path="/mnt")
[34m[1mwandb[39m[22m: [33mWARNING[39m Saving files without folders. If you want to preserve sub directories pass base_path to wandb.save, i.e. wandb.save("/mnt/folder/file.h5", base_path="/mnt")
[34m[1mwandb[39m[22m: [33mWARNING[39m Saving files without folders. If you want to preserve sub directories pass base_path to wandb.save, i.e. wandb.save("/mnt/folder/file.h5", base_path="/mnt")
Model Loaded
=========================================================================================================================
Epoch: 0
=========================================================================================================================























































1074it [01:50,  9.18it/s]

1081it [01:51,  9.66it/s]
Evaluation:   0%|                                                                                                                                      | 0/100 [00:04<?, ?it/s]
Traceback (most recent call last):
  File "simclr_sleepedf/ts_main.py", line 33, in <module>
    model.fit()
  File "/home/vamsi81523/me_v2/simclr_sleepedf/trainer.py", line 129, in fit
    f1, kappa, bal_acc, acc = self.do_kfold()
  File "/home/vamsi81523/me_v2/simclr_sleepedf/trainer.py", line 83, in do_kfold
    f1, kappa, bal_acc, acc = self.ft_fun(self.name, train_loader,test_loader)
  File "/home/vamsi81523/me_v2/simclr_sleepedf/trainer.py", line 68, in ft_fun
    f1,kappa,bal_acc,acc = sleep_eval.fit()
  File "/home/vamsi81523/me_v2/simclr_sleepedf/trainer.py", line 238, in fit
    val_loss = self.validation_epoch_end(ft_outputs)
  File "/home/vamsi81523/me_v2/simclr_sleepedf/trainer.py", line 194, in validation_epoch_end
    epoch_loss = torch.hstack([x['loss'] for x in outputs]).mean()
  File "/home/vamsi81523/me_v2/simclr_sleepedf/trainer.py", line 194, in <listcomp>
    epoch_loss = torch.hstack([x['loss'] for x in outputs]).mean()
TypeError: string indices must be integers